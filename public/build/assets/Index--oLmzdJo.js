import{j as J,i as y,r as _,x as K,k as O,y as X,f as n,o as i,a,u as l,g as Y,w as d,b as s,h as b,c as N,e as u,F as P,l as L,t as h,S as Z,n as V,d as ee,W as C}from"./app-1Y8zgK_u.js";import{A as se}from"./AuthenticatedLayout-C3U01NLj.js";import{_ as T}from"./PrimaryButton-qr8OK47F.js";import{_ as A}from"./SecondaryButton-BzBKOSNX.js";import{_ as U,D as te}from"./Modal-BfnrhBMy.js";import{_ as j}from"./InputError-DElB5cka.js";import{_ as B}from"./InputLabel-C134EFyr.js";import{_ as $}from"./TextInput-C6vV7-lH.js";import{_ as re}from"./Toast-NILzICf9.js";import{l as ae}from"./lodash-D_sEwA76.js";import{r as oe}from"./PlusIcon-6rUJEBYi.js";import{r as le,a as ie}from"./TrashIcon-Db5FgZWt.js";import"./XMarkIcon-CHTrPqRh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ExclamationTriangleIcon--pKVNfcl.js";const ne={class:"pb-12 pt-4"},de={class:"max-w-full mx-auto"},me={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},ue={class:"p-6 text-gray-900 dark:text-gray-100"},pe={class:"mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4"},ce={class:"flex flex-col sm:flex-row items-center gap-3 flex-grow"},ge={class:"overflow-x-auto"},fe={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},xe={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ve={key:0},ye={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},_e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},be={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},he=["onClick"],ke=["onClick"],we={key:0,class:"p-4 border-t border-gray-200 dark:border-gray-700"},Pe={class:"flex flex-wrap -mb-1 justify-center"},Ce=["innerHTML"],Me={class:"p-6"},Se={class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4 border-b pb-3 dark:border-gray-700"},Ve={class:"mt-6 flex justify-end space-x-3 pt-4 border-t dark:border-gray-700"},$e={class:"p-6"},Ee={class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},De={class:"font-semibold"},Ne={class:"mt-6 flex justify-end space-x-3"},Ke={__name:"Index",setup(Le){const f=J(),m=y(()=>f.props.permissions),E=y(()=>f.props.filters||{}),M=y(()=>f.props.can||{}),F=y(()=>{var o;return(o=f.props.flash)==null?void 0:o.message}),H=y(()=>{var o;return((o=f.props.flash)==null?void 0:o.type)||"info"}),k=_(!1),p=_(!1),t=K({id:null,name:"",guard_name:"web"}),x=_(E.value.search||""),W=()=>{C.get(route("admin.permissions.index"),{search:x.value,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};O(x,ae.debounce(W,300));const G=()=>{p.value=!1,t.reset(),t.guard_name="web",t.clearErrors(),k.value=!0},I=o=>{p.value=!0,t.reset(),t.clearErrors(),t.id=o.id,t.name=o.name,t.guard_name=o.guard_name,k.value=!0},S=()=>{k.value=!1,t.reset(),t.clearErrors()},R=()=>{const o=p.value?route("admin.permissions.update",t.id):route("admin.permissions.store"),e=p.value?"put":"post";t.submit(e,o,{preserveScroll:!0,onSuccess:()=>{S()},onError:w=>{console.error("Permission form submission error:",w)}})},c=_(!1),g=_(null),q=o=>{g.value=o,c.value=!0},z=()=>{g.value&&C.delete(route("admin.permissions.destroy",g.value.id),{preserveScroll:!0,onSuccess:()=>{g.value=null,c.value=!1},onError:o=>{console.error("Delete permission error:",o),g.value=null,c.value=!1}})};return X(()=>{const o=new URLSearchParams(window.location.search);x.value=o.get("search")||E.value.search||""}),(o,e)=>(i(),n(P,null,[a(l(Y),{title:"Manage Permissions"}),a(se,null,{header:d(()=>e[5]||(e[5]=[s("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Permission Management",-1)])),default:d(()=>{var w;return[a(re,{message:F.value,type:H.value},null,8,["message","type"]),s("div",ne,[s("div",de,[s("div",me,[s("div",ue,[s("div",pe,[s("div",ce,[a($,{type:"text",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=r=>x.value=r),placeholder:"Search permission name...",class:"w-full sm:w-auto md:flex-grow lg:max-w-xs","aria-label":"Search permissions"},null,8,["modelValue"])]),(w=M.value)!=null&&w.create_permission?(i(),N(T,{key:0,onClick:G,class:"w-full md:w-auto"},{default:d(()=>[a(l(oe),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),e[6]||(e[6]=u(" Add New Permission "))]),_:1})):b("",!0)]),s("div",ge,[s("table",fe,[e[8]||(e[8]=s("thead",{class:"bg-gray-50 dark:bg-gray-700"},[s("tr",null,[s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Permission Name"),s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Guard"),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),s("tbody",xe,[!m.value||!m.value.data||m.value.data.length===0?(i(),n("tr",ve,e[7]||(e[7]=[s("td",{colspan:"3",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"},"No permissions found.",-1)]))):b("",!0),(i(!0),n(P,null,L(m.value.data,r=>{var v,D;return i(),n("tr",{key:r.id},[s("td",ye,h(r.name),1),s("td",_e,h(r.guard_name),1),s("td",be,[(v=M.value)!=null&&v.edit_permission?(i(),n("button",{key:0,onClick:Q=>I(r),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 p-1 mr-2",title:"Edit Permission"},[a(l(le),{class:"h-5 w-5"})],8,he)):b("",!0),(D=M.value)!=null&&D.delete_permission?(i(),n("button",{key:1,onClick:Q=>q(r),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1",title:"Delete Permission"},[a(l(ie),{class:"h-5 w-5"})],8,ke)):b("",!0)])])}),128))])])]),m.value&&m.value.links&&m.value.links.length>3?(i(),n("div",we,[s("div",Pe,[(i(!0),n(P,null,L(m.value.links,(r,v)=>(i(),n(P,{key:v},[r.url===null?(i(),n("div",{key:0,class:"mr-1 mb-1 px-3 py-2 text-sm leading-4 text-gray-400 dark:text-gray-500 border rounded dark:border-gray-600 select-none",innerHTML:r.label},null,8,Ce)):(i(),N(l(Z),{key:1,class:V(["mr-1 mb-1 px-3 py-2 text-sm leading-4 border rounded dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 focus:border-indigo-500 dark:focus:border-indigo-700 focus:text-indigo-500 dark:focus:text-indigo-300",{"bg-indigo-500 text-white dark:bg-indigo-600 dark:text-white dark:border-indigo-700":r.active}]),href:r.url,innerHTML:r.label,"preserve-scroll":""},null,8,["class","href","innerHTML"]))],64))),128))])])):b("",!0)])])])]),a(U,{show:k.value,onClose:S,maxWidth:"lg"},{default:d(()=>[s("div",Me,[s("h2",Se,h(p.value?"Edit Permission":"Create New Permission"),1),s("form",{onSubmit:ee(R,["prevent"]),class:"space-y-6"},[s("div",null,[a(B,{for:"permission_name_modal",value:"Permission Name"}),a($,{id:"permission_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=r=>l(t).name=r),required:"",autofocus:"",placeholder:"e.g., manage_users or view_reports"},null,8,["modelValue"]),a(j,{class:"mt-2",message:l(t).errors.name},null,8,["message"])]),s("div",null,[a(B,{for:"permission_guard_name_modal",value:"Guard Name"}),a($,{id:"permission_guard_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(t).guard_name,"onUpdate:modelValue":e[2]||(e[2]=r=>l(t).guard_name=r),placeholder:"web"},null,8,["modelValue"]),a(j,{class:"mt-2",message:l(t).errors.guard_name},null,8,["message"]),e[9]||(e[9]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Usually 'web' for web routes, or 'api' for API routes. Leave blank to use default ('web').",-1))]),s("div",Ve,[a(A,{onClick:S,type:"button"},{default:d(()=>e[10]||(e[10]=[u(" Cancel ")])),_:1}),a(T,{class:V({"opacity-25":l(t).processing}),disabled:l(t).processing},{default:d(()=>[u(h(p.value?"Update Permission":"Create Permission"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]),a(U,{show:c.value,onClose:e[4]||(e[4]=r=>c.value=!1),maxWidth:"md"},{default:d(()=>{var r;return[s("div",$e,[e[15]||(e[15]=s("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Confirm Delete Permission ",-1)),s("p",Ee,[e[11]||(e[11]=u(' Are you sure you want to delete permission "')),s("span",De,h((r=g.value)==null?void 0:r.name),1),e[12]||(e[12]=u('"? This might affect roles that use this permission. '))]),s("div",Ne,[a(A,{onClick:e[3]||(e[3]=v=>c.value=!1),type:"button"},{default:d(()=>e[13]||(e[13]=[u(" Cancel ")])),_:1}),a(te,{onClick:z,class:V({"opacity-25":l(C).processing||l(t).processing}),disabled:l(C).processing||l(t).processing},{default:d(()=>e[14]||(e[14]=[u(" Delete Permission ")])),_:1},8,["class","disabled"])])])]}),_:1},8,["show"])]}),_:1})],64))}};export{Ke as default};
