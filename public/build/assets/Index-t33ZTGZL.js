import{j as K,i as y,r as k,x as O,k as X,y as Y,f as n,o as d,a as r,u as l,g as Z,w as i,b as e,h as v,c as j,e as c,F as b,l as E,t as p,S as ee,n as D,d as te,W as M}from"./app-uG_Ut-Td.js";import{A as se}from"./AuthenticatedLayout-XBVBvuiC.js";import{_ as U}from"./PrimaryButton-Cf_dIBSR.js";import{_ as A}from"./SecondaryButton-BTBcrxEK.js";import{_ as B,D as ae}from"./Modal-BnI9BkGT.js";import{_ as N}from"./InputError-Bh-0hY5P.js";import{_ as T}from"./InputLabel-BieNfq3Q.js";import{_ as L}from"./TextInput-D9MmRmYL.js";import{_ as re}from"./Checkbox-Yk0oeedd.js";import{_ as oe}from"./Toast-aKBHL2Zb.js";import{l as le}from"./lodash-Bod6gNoO.js";import{r as de}from"./PlusIcon-Cisso149.js";import{r as ne,a as ie}from"./TrashIcon-6Agr2d2E.js";import"./XMarkIcon-CvPTwrjB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ExclamationTriangleIcon-Dw2vy__R.js";const me={class:"pb-12 pt-4"},ue={class:"max-w-7xl mx-auto"},ce={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},pe={class:"p-6 text-gray-900 dark:text-gray-100"},ge={class:"mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4"},xe={class:"flex flex-col md:flex-row md:justify-between md:items-center gap-4"},fe={class:"flex-grow"},_e={class:"overflow-x-auto"},ye={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ve={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},he={key:0},ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},we={class:"px-6 py-4 whitespace-normal text-sm text-gray-500 dark:text-gray-300 break-words max-w-xs"},Ce={key:0,class:"text-xs"},Re={key:1,class:"text-xs text-gray-400"},Me={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},$e=["onClick"],Se=["onClick"],Ve={key:0,class:"p-4 border-t border-gray-200 dark:border-gray-700"},Ee={class:"flex flex-wrap -mb-1 justify-center"},De=["innerHTML"],Ne={class:"p-6"},Te={class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4 border-b pb-3 dark:border-gray-700"},Le={key:0},Pe={class:"mt-2 grid grid-cols-2 sm:grid-cols-3 gap-x-6 gap-y-3 max-h-60 overflow-y-auto p-2 border dark:border-gray-700 rounded-md"},je={class:"text-sm text-gray-700 dark:text-gray-300"},Ue={class:"mt-6 flex justify-end space-x-3 pt-4 border-t dark:border-gray-700"},Ae={class:"p-6"},Be={class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Fe={class:"font-semibold"},He={class:"mt-6 flex justify-end space-x-3"},ot={__name:"Index",setup(We){const g=K(),m=y(()=>g.props.roles),P=y(()=>g.props.filters||{}),$=y(()=>g.props.allPermissions||[]),S=y(()=>g.props.can||{}),F=y(()=>{var o;return(o=g.props.flash)==null?void 0:o.message}),H=y(()=>{var o;return((o=g.props.flash)==null?void 0:o.type)||"info"}),w=k(!1),x=k(!1),a=O({id:null,name:"",guard_name:"web",permissions:[]}),h=k(P.value.search||""),W=()=>{M.get(route("admin.roles.index"),{search:h.value,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};X(h,le.debounce(W,300));const G=()=>{x.value=!1,a.reset(),a.guard_name="web",a.clearErrors(),w.value=!0},q=o=>{x.value=!0,a.reset(),a.clearErrors(),a.id=o.id,a.name=o.name,a.guard_name=o.guard_name,a.permissions=o.permissions?[...o.permissions]:[],w.value=!0},V=()=>{w.value=!1,a.reset(),a.clearErrors()},z=()=>{const o=x.value?route("admin.roles.update",a.id):route("admin.roles.store"),t=x.value?"put":"post";a.submit(t,o,{preserveScroll:!0,onSuccess:()=>{V()},onError:C=>{console.error("Role form submission error:",C)}})},f=k(!1),_=k(null),I=o=>{_.value=o,f.value=!0},Q=()=>{_.value&&M.delete(route("admin.roles.destroy",_.value.id),{preserveScroll:!0,onSuccess:()=>{_.value=null,f.value=!1},onError:o=>{console.error("Delete role error:",o),_.value=null,f.value=!1}})};return Y(()=>{const o=new URLSearchParams(window.location.search);h.value=o.get("search")||P.value.search||""}),(o,t)=>(d(),n(b,null,[r(l(Z),{title:"Manage Roles"}),r(se,null,{header:i(()=>t[6]||(t[6]=[e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Role Management",-1)])),default:i(()=>{var C;return[r(oe,{message:F.value,type:H.value},null,8,["message","type"]),e("div",me,[e("div",ue,[e("div",ce,[e("div",pe,[e("div",ge,[e("div",xe,[e("div",fe,[r(L,{type:"text",modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),placeholder:"Search role name...",class:"w-full md:max-w-sm","aria-label":"Search roles"},null,8,["modelValue"])])]),(C=S.value)!=null&&C.create_role?(d(),j(U,{key:0,onClick:G,class:"w-full md:w-auto mt-2 md:mt-0"},{default:i(()=>[r(l(de),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),t[7]||(t[7]=c(" Add New Role "))]),_:1})):v("",!0)]),e("div",_e,[e("table",ye,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Role Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Guard"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Permissions"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ve,[!m.value||!m.value.data||m.value.data.length===0?(d(),n("tr",he,t[8]||(t[8]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400"},"No roles found.",-1)]))):v("",!0),(d(!0),n(b,null,E(m.value.data,s=>{var u,R;return d(),n("tr",{key:s.id},[e("td",ke,p(s.name),1),e("td",be,p(s.guard_name),1),e("td",we,[s.permissions_string&&s.permissions_string.length>0?(d(),n("span",Ce,p(s.permissions_string),1)):(d(),n("span",Re,"No Permissions"))]),e("td",Me,[(u=S.value)!=null&&u.edit_role?(d(),n("button",{key:0,onClick:J=>q(s),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-200 p-1 mr-2",title:"Edit Role"},[r(l(ne),{class:"h-5 w-5"})],8,$e)):v("",!0),(R=S.value)!=null&&R.delete_role?(d(),n("button",{key:1,onClick:J=>I(s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1",title:"Delete Role"},[r(l(ie),{class:"h-5 w-5"})],8,Se)):v("",!0)])])}),128))])])]),m.value&&m.value.links&&m.value.links.length>3?(d(),n("div",Ve,[e("div",Ee,[(d(!0),n(b,null,E(m.value.links,(s,u)=>(d(),n(b,{key:u},[s.url===null?(d(),n("div",{key:0,class:"mr-1 mb-1 px-3 py-2 text-sm leading-4 text-gray-400 dark:text-gray-500 border rounded dark:border-gray-600 select-none",innerHTML:s.label},null,8,De)):(d(),j(l(ee),{key:1,class:D(["mr-1 mb-1 px-3 py-2 text-sm leading-4 border rounded dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 focus:border-indigo-500 dark:focus:border-indigo-700 focus:text-indigo-500 dark:focus:text-indigo-300",{"bg-indigo-500 text-white dark:bg-indigo-600 dark:text-white dark:border-indigo-700":s.active}]),href:s.url,innerHTML:s.label,"preserve-scroll":""},null,8,["class","href","innerHTML"]))],64))),128))])])):v("",!0)])])])]),r(B,{show:w.value,onClose:V,maxWidth:"2xl"},{default:i(()=>[e("div",Ne,[e("h2",Te,p(x.value?"Edit Role":"Create New Role"),1),e("form",{onSubmit:te(z,["prevent"]),class:"space-y-6"},[e("div",null,[r(T,{for:"role_name_modal",value:"Role Name"}),r(L,{id:"role_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(a).name,"onUpdate:modelValue":t[1]||(t[1]=s=>l(a).name=s),required:"",autofocus:""},null,8,["modelValue"]),r(N,{class:"mt-2",message:l(a).errors.name},null,8,["message"])]),e("div",null,[r(T,{for:"role_guard_name_modal",value:"Guard Name (e.g., web, api)"}),r(L,{id:"role_guard_name_modal",type:"text",class:"mt-1 block w-full",modelValue:l(a).guard_name,"onUpdate:modelValue":t[2]||(t[2]=s=>l(a).guard_name=s),placeholder:"web"},null,8,["modelValue"]),r(N,{class:"mt-2",message:l(a).errors.guard_name},null,8,["message"])]),$.value&&$.value.length>0?(d(),n("div",Le,[r(T,{value:"Permissions",class:"mb-1"}),e("div",Pe,[(d(!0),n(b,null,E($.value,(s,u)=>(d(),n("label",{key:"perm_opt_"+u,class:"flex items-center space-x-2 cursor-pointer"},[r(re,{id:"permission_modal_"+u,value:s,checked:l(a).permissions,"onUpdate:checked":t[3]||(t[3]=R=>l(a).permissions=R)},null,8,["id","value","checked"]),e("span",je,p(s.replace(/_/g," ")),1)]))),128))]),r(N,{class:"mt-2",message:l(a).errors.permissions},null,8,["message"])])):v("",!0),e("div",Ue,[r(A,{onClick:V,type:"button"},{default:i(()=>t[10]||(t[10]=[c(" Cancel ")])),_:1}),r(U,{class:D({"opacity-25":l(a).processing}),disabled:l(a).processing},{default:i(()=>[c(p(x.value?"Update Role":"Create Role"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]),r(B,{show:f.value,onClose:t[5]||(t[5]=s=>f.value=!1),maxWidth:"md"},{default:i(()=>{var s;return[e("div",Ae,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Confirm Delete Role ",-1)),e("p",Be,[t[11]||(t[11]=c(' Are you sure you want to delete role "')),e("span",Fe,p((s=_.value)==null?void 0:s.name),1),t[12]||(t[12]=c('"? This action cannot be undone. '))]),e("div",He,[r(A,{onClick:t[4]||(t[4]=u=>f.value=!1),type:"button"},{default:i(()=>t[13]||(t[13]=[c(" Cancel ")])),_:1}),r(ae,{onClick:Q,class:D({"opacity-25":l(M).processing||l(a).processing}),disabled:l(M).processing||l(a).processing},{default:i(()=>t[14]||(t[14]=[c(" Delete Role ")])),_:1},8,["class","disabled"])])])]}),_:1},8,["show"])]}),_:1})],64))}};export{ot as default};
