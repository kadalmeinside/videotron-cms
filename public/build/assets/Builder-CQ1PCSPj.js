import{r as D,x as T,a0 as q,f as i,o as d,a as l,u as o,g as G,w as m,b as s,h as b,e as p,F as f,l as v,t as n,d as W,q as $,v as C,c as H,n as K,S as z,a1 as B,W as E}from"./app-CPhxPLrA.js";import{c as Q,A as R}from"./AuthenticatedLayout-CzYuN022.js";import{_ as X,D as Y}from"./Modal-COFi4xGw.js";import{_ as j}from"./InputLabel-B_wm-awJ.js";import{_ as V}from"./PrimaryButton-DgYbJ7mL.js";import{_ as Z}from"./SecondaryButton-BTLkx_dz.js";import{_ as ee}from"./Toast-BtswQNda.js";import{_ as te}from"./TextInput-CE9FDaPe.js";import{r as A,a as se}from"./PlusIcon-CjDroSnu.js";import"./XMarkIcon-Cg4hbH_O.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"flex items-center"},oe={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},re={class:"text-[--color-primary-600]"},le={class:"py-12"},de={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ie={class:"space-y-8"},ne={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm"},ue={class:"mt-4 flex items-end gap-4"},me={key:0,class:"text-center bg-white dark:bg-gray-800 p-12 rounded-lg shadow-sm"},ce={class:"p-6"},pe={class:"flex justify-between items-center border-b pb-2 mb-4"},ye={class:"text-lg font-medium text-gray-900 dark:text-white"},ge=["onClick"],_e={class:"space-y-3"},he={class:"flex items-center gap-4"},fe={class:"font-mono text-lg text-[--color-primary-600] dark:text-[--color-primary-400]"},ve={class:"font-medium text-gray-800 dark:text-gray-200"},xe={class:"text-xs text-gray-500"},we=["onClick"],ke={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},be={class:"text-sm text-gray-500"},Se={class:"mt-6 space-y-4"},De={class:"flex items-center gap-2 mt-1"},$e=["value"],Ce=["value"],je={key:0,class:"text-sm text-red-600 mt-2"},Ie=["value"],Me={key:0,class:"text-sm text-red-600 mt-2"},Te={class:"mt-6 flex justify-between"},Be={class:"flex justify-end gap-x-2"},We={__name:"Builder",props:{videotron:Object,scheduledDays:Object,allMedia:Array},setup(y){const J=y,x=D(!1),g=D(!1),_=D({message:"",type:"info",show:!1}),t=T({id:null,schedule_date:"",play_hour:"07",play_minute:"00",media_id:""}),S=T({date:new Date().toISOString().slice(0,10)}),F=Array.from({length:24},(r,e)=>e.toString().padStart(2,"0")),L=Array.from({length:60},(r,e)=>e.toString().padStart(2,"0")),I=()=>{t.clearErrors();let r=!0;return t.media_id||(t.setError("media_id","Media wajib dipilih."),r=!1),r},M=r=>{g.value=!1,t.reset(),t.clearErrors(),t.schedule_date=r,x.value=!0},N=(r,e)=>{g.value=!0,t.reset(),t.clearErrors();const c=new Date(r.play_at);t.id=r.id,t.schedule_date=e,t.play_hour=c.getHours().toString().padStart(2,"0"),t.play_minute=c.getMinutes().toString().padStart(2,"0"),t.media_id=r.media_id,x.value=!0},w=()=>{x.value=!1},O=async()=>{if(!I())return;t.processing=!0;const e={play_time:`${t.play_hour}:${t.play_minute}`,schedule_date:t.schedule_date,media_id:t.media_id,videotron_id:J.videotron.id},c=g.value?route("api.admin.schedule-items.update",t.id):route("api.admin.schedule-items.store"),a=g.value?"put":"post";try{const u=await B[a](c,e);w(),E.reload({only:["scheduledDays"],onSuccess:()=>{k(u.data.message,"success")}})}catch(u){u.response&&u.response.status===422?t.setError(u.response.data.errors):(console.error("Terjadi kesalahan tak terduga:",u),k("Terjadi kesalahan tak terduga saat menyimpan.","error"))}finally{t.processing=!1}},P=async()=>{if(confirm("Apakah Anda yakin ingin menghapus item jadwal ini?")){t.processing=!0;try{await B.delete(route("api.admin.schedule-items.destroy",t.id)),w(),E.reload({only:["scheduledDays"],onSuccess:()=>{k("Item jadwal berhasil dihapus.","success")}})}catch(r){console.error("Gagal menghapus item:",r),k("Gagal menghapus item.","error")}finally{t.processing=!1}}},U=r=>r?new Date(r).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"",k=(r,e="info")=>{_.value={message:r,type:e,show:!0},setTimeout(()=>{_.value.show=!1},4e3)};return(r,e)=>{const c=q("InputError");return d(),i(f,null,[l(o(G),{title:`Jadwal untuk ${y.videotron.name}`},null,8,["title"]),l(R,null,{header:m(()=>[s("div",ae,[l(o(z),{href:r.route("admin.schedules.index"),class:"mr-4 text-gray-500 hover:text-gray-700"},{default:m(()=>e[6]||(e[6]=[p(" â† Kembali ")])),_:1},8,["href"]),s("h2",oe,[e[7]||(e[7]=p(" Jadwal untuk ")),s("span",re,n(y.videotron.name),1)])])]),default:m(()=>[l(ee,{message:_.value.message,type:_.value.type,show:_.value.show,onClose:e[0]||(e[0]=a=>_.value.show=!1)},null,8,["message","type","show"]),s("div",le,[s("div",de,[s("div",ie,[s("div",ne,[e[9]||(e[9]=s("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Buat Jadwal untuk Tanggal Baru",-1)),s("div",ue,[s("div",null,[l(j,{for:"new_date",value:"Pilih Tanggal"}),l(te,{id:"new_date",type:"date",modelValue:o(S).date,"onUpdate:modelValue":e[1]||(e[1]=a=>o(S).date=a),class:"mt-1"},null,8,["modelValue"])]),l(V,{onClick:e[2]||(e[2]=a=>M(o(S).date))},{default:m(()=>[l(o(A),{class:"h-5 w-5 mr-2"}),e[8]||(e[8]=p(" Buat Jadwal "))]),_:1})])]),Object.keys(y.scheduledDays).length===0?(d(),i("div",me,[l(o(Q),{class:"mx-auto h-12 w-12 text-gray-400"}),e[10]||(e[10]=s("h3",{class:"mt-2 text-sm font-semibold text-gray-900 dark:text-white"},"Jadwal Kosong",-1)),e[11]||(e[11]=s("p",{class:"mt-1 text-sm text-gray-500"},"Belum ada jadwal yang dibuat untuk videotron ini. Gunakan form di atas untuk memulai.",-1))])):b("",!0),(d(!0),i(f,null,v(y.scheduledDays,(a,u)=>(d(),i("div",{key:u,class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},[s("div",ce,[s("div",pe,[s("h3",ye,n(new Date(u+"T00:00:00").toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),1),s("button",{onClick:h=>M(u),class:"text-sm font-semibold text-[--color-primary-600] hover:text-[--color-primary-500] flex items-center gap-1"},[l(o(A),{class:"h-4 w-4"}),e[12]||(e[12]=p(" Tambah Item "))],8,ge)]),s("ul",_e,[(d(!0),i(f,null,v(a,h=>(d(),i("li",{key:h.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md"},[s("div",he,[s("span",fe,n(U(h.play_at)),1),s("p",ve,n(h.media.title),1),s("span",xe,"("+n(h.media.duration)+" detik)",1)]),s("div",null,[s("button",{onClick:Ee=>N(h,u),class:"text-gray-400 hover:text-gray-600 dark:hover:text-white"},[l(o(se),{class:"h-5 w-5"})],8,we)])]))),128))])])]))),128))])])]),l(X,{show:x.value,onClose:w},{default:m(()=>[s("form",{onSubmit:W(O,["prevent"]),class:"p-6",novalidate:""},[s("h2",ke,n(g.value?"Edit":"Tambah")+" Item Jadwal ",1),s("p",be,"untuk tanggal "+n(o(t).schedule_date),1),s("div",Se,[s("div",null,[l(j,{for:"play_hour",value:"Waktu Putar",required:""}),s("div",De,[$(s("select",{id:"play_hour","onUpdate:modelValue":e[3]||(e[3]=a=>o(t).play_hour=a),class:"w-full border-gray-300 rounded-md shadow-sm"},[(d(!0),i(f,null,v(o(F),a=>(d(),i("option",{key:a,value:a},n(a),9,$e))),128))],512),[[C,o(t).play_hour]]),e[13]||(e[13]=s("span",{class:"font-bold"},":",-1)),$(s("select",{id:"play_minute","onUpdate:modelValue":e[4]||(e[4]=a=>o(t).play_minute=a),class:"w-full border-gray-300 rounded-md shadow-sm"},[(d(!0),i(f,null,v(o(L),a=>(d(),i("option",{key:a,value:a},n(a),9,Ce))),128))],512),[[C,o(t).play_minute]])]),l(c,{message:o(t).errors.play_time,class:"mt-2"},null,8,["message"]),o(t).errors.play_time?(d(),i("p",je,n(o(t).errors.play_time),1)):b("",!0)]),s("div",null,[l(j,{for:"media_id",value:"Pilih Media",required:""}),$(s("select",{id:"media_id","onUpdate:modelValue":e[5]||(e[5]=a=>o(t).media_id=a),onChange:I,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},[e[14]||(e[14]=s("option",{disabled:"",value:""},"-- Pilih Media --",-1)),(d(!0),i(f,null,v(y.allMedia,a=>(d(),i("option",{key:a.id,value:a.id},n(a.title)+" ("+n(a.duration)+" detik) ",9,Ie))),128))],544),[[C,o(t).media_id]]),l(c,{message:o(t).errors.media_id,class:"mt-2"},null,8,["message"]),o(t).errors.media_id?(d(),i("p",Me,n(o(t).errors.media_id),1)):b("",!0)])]),s("div",Te,[s("div",null,[g.value?(d(),H(Y,{key:0,onClick:P,type:"button"},{default:m(()=>e[15]||(e[15]=[p("Hapus")])),_:1})):b("",!0)]),s("div",Be,[l(Z,{onClick:w,type:"button"},{default:m(()=>e[16]||(e[16]=[p("Batal")])),_:1}),l(V,{class:K({"opacity-25":o(t).processing}),disabled:o(t).processing},{default:m(()=>e[17]||(e[17]=[p(" Simpan ")])),_:1},8,["class","disabled"])])])],32)]),_:1},8,["show"])]),_:1})],64)}}};export{We as default};
