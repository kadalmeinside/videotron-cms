import{f as n,o,b as l,i as g,h as x,a as r,u as a,d as I,j as z,r as f,x as Q,k as X,W as F,g as ee,w as d,c as E,e as M,F as T,l as q,t as c,n as C,p as P,v as te,s as le}from"./app-riK_Pjuz.js";import{a as se,A as ae}from"./AuthenticatedLayout-lOswsTzd.js";import{l as re}from"./lodash-CnciMvR8.js";import{_ as R}from"./PrimaryButton-DS45Yteh.js";import{_ as A,D as oe}from"./Modal-K-nGm6d_.js";import{_ as m}from"./InputLabel-BcSCvgN5.js";import{_ as L}from"./TextInput-B-WSdySS.js";import{_ as p}from"./InputError-1u9de0yr.js";import{_ as H}from"./SecondaryButton-jxNy2iAV.js";import{r as ne}from"./XCircleIcon-CD5wvQ1o.js";import{r as ie}from"./PlusIcon-CY9-_vLd.js";import{r as ue}from"./PencilIcon-aRUZtyvS.js";import{r as de}from"./TrashIcon-BnsH1_BD.js";import"./XMarkIcon-5zbANY7g.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function me($,u){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15"})])}function ce($,u){return o(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[l("path",{d:"M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z"})])}const pe={key:0,class:"relative w-full h-32 border-2 border-dashed rounded-lg flex items-center justify-center bg-gray-100"},_e=["src"],O={__name:"ImagePreview",props:{existingUrl:{type:String,default:null},file:{type:File,default:null}},emits:["clear"],setup($,{emit:u}){const v=$,V=g(()=>v.file?URL.createObjectURL(v.file):v.existingUrl);return(S,B)=>V.value?(o(),n("div",pe,[l("img",{src:V.value,class:"max-w-full max-h-full object-contain",alt:"Image Preview"},null,8,_e),l("button",{onClick:B[0]||(B[0]=I(y=>S.$emit("clear"),["prevent"])),type:"button",class:"absolute -top-2 -right-2 bg-white rounded-full text-gray-500 hover:text-red-600 transition",title:"Hapus gambar"},[r(a(ne),{class:"h-6 w-6"})])])):x("",!0)}},fe={class:"pb-12 pt-4"},ge={class:"max-w-full mx-auto"},xe={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},ve={class:"p-6 text-gray-900 dark:text-gray-100"},ye={class:"mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4"},be={class:"overflow-x-auto"},he={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},we={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ke={key:0},Me={class:"px-4 py-2"},Ce=["src"],$e={key:1,class:"text-sm text-gray-400"},Ve={class:"px-4 py-2 font-medium text-sm text-gray-900 dark:text-white"},Be={class:"px-4 py-2 text-sm text-gray-500 dark:text-gray-300"},Ue={class:"px-4 py-2 text-sm"},Le=["href"],Se={key:1,class:"text-gray-400"},je={class:"px-4 py-2 text-sm"},Fe=["href"],Ee={key:1,class:"text-gray-400"},Te={class:"px-4 py-2 text-sm"},De={class:"px-4 py-2 whitespace-nowrap text-right text-sm"},Ze=["onClick"],qe=["onClick"],Pe={class:"text-lg font-bold border-b pb-3 mb-6"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6"},Ae={class:"space-y-6"},He=["value"],Oe={class:"mt-2 grid grid-cols-3 gap-3"},Ie={key:0},Ke={key:1},Ne={key:0,class:"text-xs text-gray-500 mt-1"},We={class:"space-y-6"},Ye={class:"mt-6 flex justify-end pt-6 border-t dark:border-gray-700"},Ge=["value"],Je={class:"p-6"},ze={class:"mt-2 text-sm text-gray-600"},Qe={class:"mt-6 flex justify-end"},_t={__name:"Index",setup($){const u=z(),v=g(()=>u.props.mediaList||{data:[]}),V=g(()=>u.props.filters||{search:""}),S=g(()=>u.props.clients||[]),B=g(()=>u.props.can||{});g(()=>{var i;return(i=u.props.flash)==null?void 0:i.message}),g(()=>{var i;return((i=u.props.flash)==null?void 0:i.type)||"info"});const y=f(!1),_=f(!1),b=f(!1),h=f(null),j=f(V.value.search),t=Q({title:"",client_id:"",source_type:"local",source_value:"",source_file:null,duration:30,top_banner_file:null,bottom_banner_file:null,running_text:"",theme_type:"solid",theme_color_1:"#000000",theme_color_2:"#FFFFFF"}),w=f(null),k=f(null);X(j,re.debounce(i=>{F.get(route("admin.media.index"),{search:i},{preserveState:!0,preserveScroll:!0,replace:!0,only:["mediaList","filters"]})},300));const K=i=>{const e=i.target.files[0];if(e){t.source_file=e;const s=document.createElement("video");s.preload="metadata",s.onloadedmetadata=()=>{window.URL.revokeObjectURL(s.src),t.duration=Math.round(s.duration)},s.src=URL.createObjectURL(e)}},D=i=>{i==="top"?(t.top_banner_file=null,w.value=null):i==="bottom"&&(t.bottom_banner_file=null,k.value=null)},N=()=>{_.value=!1,t.reset(),t.clearErrors(),w.value=null,k.value=null,y.value=!0},W=i=>{const e=i.full_data_for_edit;_.value=!0,t.reset(),t.clearErrors(),t.id=e.id,t.title=e.title,t.client_id=e.client_id,t.source_type=e.source_type,t.source_value=e.source_value,t.duration=e.duration,t.running_text=e.running_text,w.value=e.top_banner_url,k.value=e.bottom_banner_url,y.value=!0},U=()=>{y.value=!1},Y=()=>{if(!_.value){t.post(route("admin.media.store"),{preserveScroll:!0,onSuccess:()=>U()});return}F.post(route("admin.media.update",t.id),{_method:"PUT",title:t.title,client_id:t.client_id,source_type:t.source_type,source_value:t.source_value,duration:t.duration,running_text:t.running_text,source_file:t.source_file,top_banner_file:t.top_banner_file,bottom_banner_file:t.bottom_banner_file},{preserveScroll:!0,onSuccess:()=>U(),onError:i=>{t.setError(i)}})},G=i=>{h.value=i,b.value=!0},J=()=>{h.value&&F.delete(route("admin.media.destroy",h.value.id),{preserveScroll:!0,onSuccess:()=>{b.value=!1,h.value=null}})};return(i,e)=>(o(),n(T,null,[r(a(ee),{title:"Manajemen Media"}),r(ae,null,{header:d(()=>e[15]||(e[15]=[l("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Manajemen Klien",-1)])),default:d(()=>[l("div",fe,[l("div",ge,[l("div",xe,[l("div",ve,[l("div",ye,[r(L,{type:"text",modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=s=>j.value=s),placeholder:"Cari judul media...",class:"w-full md:max-w-md"},null,8,["modelValue"]),B.value.manage_media?(o(),E(R,{key:0,onClick:N},{default:d(()=>[r(a(ie),{class:"h-5 w-5 mr-2"}),e[16]||(e[16]=M(" Tambah Media "))]),_:1})):x("",!0)]),l("div",be,[l("table",he,[e[18]||(e[18]=l("thead",{class:"bg-gray-50 dark:bg-gray-700"},[l("tr",null,[l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Preview"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Judul"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Klien"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Top Banner"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Bottom Banner"),l("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),l("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi")])],-1)),l("tbody",we,[v.value.data.length?x("",!0):(o(),n("tr",ke,e[17]||(e[17]=[l("td",{colspan:"7",class:"px-6 py-4 text-center text-gray-500"},"Belum ada media.",-1)]))),(o(!0),n(T,null,q(v.value.data,s=>(o(),n("tr",{key:s.id},[l("td",Me,[s.preview_url?(o(),n("img",{key:0,src:s.preview_url,class:"w-24 h-14 object-cover rounded bg-gray-200",alt:"preview"},null,8,Ce)):(o(),n("span",$e,c(s.source_type),1))]),l("td",Ve,c(s.title),1),l("td",Be,c(s.client.company_name),1),l("td",Ue,[s.top_banner_url?(o(),n("a",{key:0,href:s.top_banner_url,target:"_blank",class:"text-blue-600 hover:underline"},"Link",8,Le)):(o(),n("span",Se,"-"))]),l("td",je,[s.bottom_banner_url?(o(),n("a",{key:0,href:s.bottom_banner_url,target:"_blank",class:"text-blue-600 hover:underline"},"Link",8,Fe)):(o(),n("span",Ee,"-"))]),l("td",Te,[l("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.is_approved?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},c(s.is_approved?"Approved":"Pending"),3)]),l("td",De,[l("button",{onClick:Z=>W(s),class:"p-1 mr-2 text-indigo-600 hover:text-indigo-900",title:"Edit Media"},[r(a(ue),{class:"h-5 w-5"})],8,Ze),l("button",{onClick:Z=>G(s),class:"p-1 text-red-600 hover:text-red-900",title:"Hapus Media"},[r(a(de),{class:"h-5 w-5"})],8,qe)])]))),128))])])])])])])]),r(A,{show:y.value,onClose:U,maxWidth:"2xl"},{default:d(()=>[l("form",{onSubmit:I(Y,["prevent"]),class:"p-6",novalidate:""},[l("h2",Pe,c(_.value?"Edit Media":"Tambah Media Baru"),1),l("div",Re,[l("div",Ae,[l("div",null,[r(m,{for:"title",value:"Judul Media",required:""}),r(L,{id:"title",modelValue:a(t).title,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).title=s),class:"w-full mt-1",placeholder:"Cth: Iklan Lebaran"},null,8,["modelValue"]),r(p,{message:a(t).errors.title,class:"mt-2"},null,8,["message"])]),l("div",null,[r(m,{for:"client_id",value:"Klien Pemilik",required:""}),P(l("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).client_id=s),class:"w-full mt-1 border-gray-300 rounded-md shadow-sm"},[e[19]||(e[19]=l("option",{disabled:"",value:""},"Pilih Klien",-1)),(o(!0),n(T,null,q(S.value,s=>(o(),n("option",{key:s.id,value:s.id},c(s.company_name),9,He))),128))],512),[[te,a(t).client_id]]),r(p,{message:a(t).errors.client_id,class:"mt-2"},null,8,["message"])]),l("div",null,[r(m,{value:"Sumber Media",required:""}),l("div",Oe,[l("button",{type:"button",onClick:e[3]||(e[3]=s=>a(t).source_type="local"),class:C([a(t).source_type==="local"?"bg-blue-600 text-white ring-2 ring-blue-400":"bg-gray-200 text-gray-600 hover:bg-gray-300 opacity-60","p-3 rounded-lg text-center transition"])},[r(a(me),{class:"h-6 w-6 mx-auto"}),e[20]||(e[20]=l("span",{class:"text-xs mt-1 block"},"Lokal",-1))],2),l("button",{type:"button",onClick:e[4]||(e[4]=s=>a(t).source_type="youtube"),class:C([a(t).source_type==="youtube"?"bg-red-600 text-white ring-2 ring-red-400":"bg-gray-200 text-gray-600 hover:bg-gray-300 opacity-60","p-3 rounded-lg text-center transition"])},[r(a(ce),{class:"h-6 w-6 mx-auto"}),e[21]||(e[21]=l("span",{class:"text-xs mt-1 block"},"YouTube",-1))],2),l("button",{type:"button",onClick:e[5]||(e[5]=s=>a(t).source_type="vimeo"),class:C([a(t).source_type==="vimeo"?"bg-sky-500 text-white ring-2 ring-sky-300":"bg-gray-200 text-gray-600 hover:bg-gray-300 opacity-60","p-3 rounded-lg text-center transition"])},[r(a(se),{class:"h-6 w-6 mx-auto"}),e[22]||(e[22]=l("span",{class:"text-xs mt-1 block"},"Vimeo",-1))],2)])]),a(t).source_type==="local"?(o(),n("div",Ie,[r(m,{for:"source_file",value:_.value?"Ganti File (Opsional)":"Pilih File (Video/Gambar)",required:!_.value},null,8,["value","required"]),l("input",{type:"file",onChange:K,accept:"video/mp4,video/quicktime,image/*",class:"w-full mt-1 block text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-600 hover:file:bg-indigo-100"},null,32),r(p,{message:a(t).errors.source_file,class:"mt-2"},null,8,["message"])])):x("",!0),a(t).source_type==="youtube"||a(t).source_type==="vimeo"?(o(),n("div",Ke,[r(m,{for:"source_value",value:"URL Video",required:""}),r(L,{id:"source_value",modelValue:a(t).source_value,"onUpdate:modelValue":e[6]||(e[6]=s=>a(t).source_value=s),class:"w-full mt-1",placeholder:"https://..."},null,8,["modelValue"]),r(p,{message:a(t).errors.source_value,class:"mt-2"},null,8,["message"])])):x("",!0),l("div",null,[r(m,{for:"duration",value:"Durasi Tayang (detik)",required:""}),r(L,{id:"duration",modelValue:a(t).duration,"onUpdate:modelValue":e[7]||(e[7]=s=>a(t).duration=s),modelModifiers:{number:!0},type:"number",class:"w-full mt-1",placeholder:"Detik",readonly:a(t).source_type==="local"&&a(t).source_file},null,8,["modelValue","readonly"]),a(t).source_type!=="local"?(o(),n("p",Ne,"Harap isi durasi manual untuk YouTube/Vimeo.")):x("",!0),r(p,{message:a(t).errors.duration,class:"mt-2"},null,8,["message"])])]),l("div",We,[l("div",null,[r(m,{for:"top_banner",value:"Banner Atas (Opsional)"}),a(t).top_banner_file||w.value?(o(),E(O,{key:0,file:a(t).top_banner_file,"existing-url":w.value,onClear:e[8]||(e[8]=s=>D("top")),class:"mt-2"},null,8,["file","existing-url"])):(o(),n("input",{key:1,type:"file",onInput:e[9]||(e[9]=s=>a(t).top_banner_file=s.target.files[0]),accept:"image/*",class:"w-full mt-1 block text-sm ..."},null,32)),r(p,{message:a(t).errors.top_banner_file,class:"mt-2"},null,8,["message"])]),l("div",null,[r(m,{for:"bottom_banner",value:"Banner Bawah (Opsional)"}),a(t).bottom_banner_file||k.value?(o(),E(O,{key:0,file:a(t).bottom_banner_file,"existing-url":k.value,onClear:e[10]||(e[10]=s=>D("bottom")),class:"mt-2"},null,8,["file","existing-url"])):(o(),n("input",{key:1,type:"file",onInput:e[11]||(e[11]=s=>a(t).bottom_banner_file=s.target.files[0]),accept:"image/*",class:"w-full mt-1 block text-sm ..."},null,32)),r(p,{message:a(t).errors.bottom_banner_file,class:"mt-2"},null,8,["message"])]),l("div",null,[r(m,{for:"running_text",value:"Running Text (Opsional)"}),P(l("textarea",{id:"running_text","onUpdate:modelValue":e[12]||(e[12]=s=>a(t).running_text=s),class:"w-full mt-1 border-gray-300 rounded-md",rows:"4"},null,512),[[le,a(t).running_text]]),r(p,{message:a(t).errors.running_text,class:"mt-2"},null,8,["message"])])])]),l("div",Ye,[a(t).progress?(o(),n("progress",{key:0,value:a(t).progress.percentage,max:"100",class:"mr-4 w-48 self-center"},null,8,Ge)):x("",!0),r(H,{onClick:U,type:"button"},{default:d(()=>e[23]||(e[23]=[M("Batal")])),_:1}),r(R,{class:C(["ml-3",{"opacity-25":a(t).processing}]),disabled:a(t).processing},{default:d(()=>[M(c(_.value?"Update Media":"Simpan Media"),1)]),_:1},8,["disabled","class"])])],32)]),_:1},8,["show"]),r(A,{show:b.value,onClose:e[14]||(e[14]=s=>b.value=!1),maxWidth:"md"},{default:d(()=>{var s;return[l("div",Je,[e[26]||(e[26]=l("h2",{class:"text-lg font-medium"},"Konfirmasi Hapus",-1)),l("p",ze,'Yakin ingin menghapus media "'+c((s=h.value)==null?void 0:s.title)+'" beserta semua filenya?',1),l("div",Qe,[r(H,{onClick:e[13]||(e[13]=Z=>b.value=!1)},{default:d(()=>e[24]||(e[24]=[M("Batal")])),_:1}),r(oe,{onClick:J,class:"ml-3"},{default:d(()=>e[25]||(e[25]=[M("Ya, Hapus")])),_:1})])])]}),_:1},8,["show"])]),_:1})],64))}};export{_t as default};
